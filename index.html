<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
<form>
    <h2 style="color: black">JWT tokenizer</h2>
    <fieldset style="width:40%">
        <input id="secret" name="secret" placeholder="Secret phrase.."
               required="" type="password" style="width:55%">
    </fieldset>
    <fieldset style="width:40%">
         <textarea id="payload" name="payload" placeholder='{"username": "Jarvis"}'
                   required="" rows="10" cols="50">{"username": "Jarvis"}</textarea>
    </fieldset>
    <fieldset style="width:40%">
        <button id="form-submit" onclick="tokenize(event)" type="submit" style="text-align:center">
            Send Now
        </button>
    </fieldset>
</form>
JWT Token: <p id="token"></p>
<script>
function base64url(source) {
  // Encode in classical base64
  encodedSource = CryptoJS.enc.Base64.stringify(source);

  // Remove padding equal characters
  encodedSource = encodedSource.replace(/=+$/, '');

  // Replace characters according to base64url specifications
  encodedSource = encodedSource.replace(/\+/g, '-');
  encodedSource = encodedSource.replace(/\//g, '_');

  return encodedSource;
}

function tokenize(e) {
    e.preventDefault();
    var secret = $("#secret").val();
    var data = $("#payload").val();
    var header = {
      "alg": "HS256",
      "typ": "JWT"
    };
    var stringifiedHeader = CryptoJS.enc.Utf8.parse(JSON.stringify(header));
    var encodedHeader = base64url(stringifiedHeader);
    var data = JSON.parse(data);
    var stringifiedData = CryptoJS.enc.Utf8.parse(JSON.stringify(data));
    var encodedData = base64url(stringifiedData);
    var token = encodedHeader + "." + encodedData;
    var signature = CryptoJS.HmacSHA256(token, secret);
    signature = base64url(signature);
    var signedToken = token + "." + signature;
    document.getElementById("token").innerHTML = signedToken;
}

// https://redis.com/blog/json-web-tokens-jwt-are-dangerous-for-user-sessions/


</script>
</body>
</html>
